{"version":3,"sources":["../../src/lib/sheet-funcs.js"],"names":["VLOOKUP","needle","table","index","exactmatch","Error","i","length","row","v","isExact","isApprox","toLowerCase","indexOf"],"mappings":";;;;;QAGgBA,O,GAAAA,O;;AAHhB;;AAEA;AACO,SAASA,OAAT,CAAiBC,MAAjB,EAAyBC,KAAzB,EAAgCC,KAAhC,EAAuCC,UAAvC,EAAmD;AACxD,MAAKH,kBAAkBI,KAAlB,IAA2BJ,WAAW,IAA3C,EAAkD;AAChD,WAAOA,MAAP;AACD;;AAEDE,UAAQA,SAAS,CAAjB;AACAC,eAAaA,cAAc,KAA3B;AACA,OAAM,IAAIE,IAAI,CAAd,EAAiBA,IAAIJ,MAAMK,MAA3B,EAAmCD,GAAnC,EAAyC;AACrC,QAAME,MAAMN,MAAMI,CAAN,CAAZ;AACA,QAAMG,IAAID,IAAI,CAAJ,CAAV;AACA,QAAME,UAAUN,cAAcK,MAAMR,MAApC;AACA,QAAMU,WAAWF,MAAMR,MAAN,IACE,OAAOQ,CAAP,KAAa,QAAb,IACEA,EAAEG,WAAF,GAAgBC,OAAhB,CAAwBZ,OAAOW,WAAP,EAAxB,KAAiD,CAAC,CAFvE;AAGA,QAAKF,WAAWC,QAAhB,EAA2B;AACvB,aAAOR,QAASK,IAAID,MAAJ,GAAa,CAAtB,GACAC,IAAIL,QAAM,CAAV,CADA,GAEAM,CAFP;AAGH;AACJ;;AAED,SAAO,IAAIJ,KAAJ,uCAAP;AACD","file":"sheet-funcs.js","sourcesContent":["import { ERROR_NOT_AVAILABLE } from 'hot-formula-parser';\n\n// For reference: https://github.com/FormulaPages/vlookup\nexport function VLOOKUP(needle, table, index, exactmatch) {             \n  if ( needle instanceof Error || needle === null ) {\n    return needle;\n  }\n\n  index = index || 0;\n  exactmatch = exactmatch || false;\n  for ( let i = 0; i < table.length; i++ ) {\n      const row = table[i];\n      const v = row[0];\n      const isExact = exactmatch && v === needle;\n      const isApprox = v === needle\n                     || (typeof v === \"string\"\n                        && v.toLowerCase().indexOf(needle.toLowerCase()) != -1);\n      if ( isExact || isApprox ) {\n          return index < (row.length + 1)\n               ? row[index-1]\n               : v;\n      }\n  }\n\n  return new Error(ERROR_NOT_AVAILABLE);\n}\n"]}